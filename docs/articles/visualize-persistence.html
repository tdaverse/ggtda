<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualizing persistent homology data • ggtda</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing persistent homology data">
<meta property="og:description" content="ggtda">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggtda</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/grouped-list-data.html">Topological analysis of grouped data and list-columns</a>
    </li>
    <li>
      <a href="../articles/illustrate-constructions.html">Illustrating topological constructions on point clouds</a>
    </li>
    <li>
      <a href="../articles/visualize-persistence.html">Visualizing persistent homology data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rrrlw/ggtda/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visualizing persistent homology data</h1>
                        <h4 data-toc-skip class="author">Jason Cory Brunson, Jacob G. Scott, Raoul R. Wadhwa</h4>
            
            <h4 data-toc-skip class="date">2024-01-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rrrlw/ggtda/blob/HEAD/vignettes/visualize-persistence.Rmd" class="external-link"><code>vignettes/visualize-persistence.Rmd</code></a></small>
      <div class="hidden name"><code>visualize-persistence.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="opening">Opening<a class="anchor" aria-label="anchor" href="#opening"></a>
</h2>
<p>The <strong>ggtda</strong> package provides users with <strong>ggplot2</strong> layers to visualize persistent homology, especially as part of a topological data analysis (TDA) pipeline. This vignette shows how to use ggtda to construct publication-quality barcode plots, persistence diagrams, and persistence landscapes.</p>
<p>We set up our environment by attaching ggtda. Other packages will be called to generate a simulated data set and to compute persistent homology.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rrrlw.github.io/ggtda/" class="external-link">ggtda</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample-data">Sample data<a class="anchor" aria-label="anchor" href="#sample-data"></a>
</h2>
<p>We use <a href="https://github.com/corybrunson/tdaunif/" class="external-link">the <strong>tdaunif</strong> package</a> to generate a sample from an interesting topological space that requires 4 Euclidean dimensions to embed: the real projective plane, denoted <span class="math inline">\(\mathbb{P}^2(\mathbb{R})\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> The sample of 240 points is generated uniformly from a commonly-used embedding <span class="math inline">\(\mathbb{P}^2(\mathbb{R}) \to \mathbb{R}^4\)</span> of the 2-dimensional manifold into 4-dimensional Euclidean space, with some 4-dimensional gaussian noise introduced.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7480L</span><span class="op">)</span></span>
<span><span class="va">rpp</span> <span class="op">&lt;-</span> <span class="fu">tdaunif</span><span class="fu">::</span><span class="fu"><a href="https://tdaverse.github.io/tdaunif/reference/real-projective-planes.html" class="external-link">sample_projective_plane</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">240L</span>, sd <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
<p>We can build some limited intuition about the space by plotting 2-coordinate projections from the point cloud:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">rpp</span>, pch <span class="op">=</span> <span class="fl">16L</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualize-persistence_files/figure-html/manifold%20sample%20pairs-1.png" width="384"></p>
<p>The real projective plane has known homology groups, given here over coefficients in <span class="math inline">\(\mathbb{F}_2\)</span>, the field of two elements:</p>
<p><span class="math display">\[
\tilde{H}_k(\mathbb{P}^2(\mathbb{R});\mathbb{F}_2)=\begin{cases}
0 &amp; k=0 \\
\mathbb{F}_2 &amp; k=1 \\
0 &amp; k&gt;1
\end{cases}
\]</span></p>
<p>Each group <span class="math inline">\(\tilde{H}_k\)</span> indicates the complexity of the space in a different dimension <span class="math inline">\(k\)</span>. For example, the real projective plane has no gaps between connected components and no enclosed cells, so its degree-0 and degree-2 homology groups are null.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> It does, however, have a “hole”, or degree-1 feature, which is detected by a single copy of the field of coefficients.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> The ranks of these three groups—<span class="math inline">\(0\)</span>, <span class="math inline">\(1\)</span>, and <span class="math inline">\(0\)</span>—count the features of each degree we should expect to emerge as the most <em>persistent</em>.</p>
</div>
<div class="section level2">
<h2 id="persistent-homology">Persistent homology<a class="anchor" aria-label="anchor" href="#persistent-homology"></a>
</h2>
<p>We will calculate the persistent homology of our sample using <a href="https://github.com/rrrlw/ripserr" class="external-link">the <strong>ripserr</strong> package</a>, specifying the prime field <code>p = 2L</code>. We will then plot several visualizations of the resulting persistent pairs using <strong>ggtda</strong>. Because the space from which the sample was taken is 2-dimensional, we run the calculation up to dimension <code>dim = 2L</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate persistent homology</span></span>
<span><span class="va">rpp_phom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">ripserr</span><span class="fu">::</span><span class="fu"><a href="https://rrrlw.github.io/ripserr/reference/vietoris_rips.html" class="external-link">vietoris_rips</a></span><span class="op">(</span><span class="va">rpp</span>, dim <span class="op">=</span> <span class="fl">2L</span>, p <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in vietoris_rips.matrix(rpp, dim = 2L, p = 2L): `dim` parameter has</span></span>
<span><span class="co">#&gt; been deprecated; use `max_dim` instead.</span></span>
<span><span class="co"># format persistence data for ggplot2</span></span>
<span><span class="va">rpp_phom</span><span class="op">$</span><span class="va">dimension</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">rpp_phom</span><span class="op">$</span><span class="va">dimension</span><span class="op">)</span></span></code></pre></div>
<p>In keeping with tidy principles, <strong>ripserr</strong> returns a data frame whose observational units (one per row) are homological features. We take a quick peek with <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">head()</a></code> and <code><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail()</a></code> to see how long the features of this point cloud tend to persist:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first few features (lowest-dimensional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rpp_phom</span><span class="op">)</span></span>
<span><span class="co">#&gt;   dimension birth      death</span></span>
<span><span class="co">#&gt; 1         0     0 0.01260948</span></span>
<span><span class="co">#&gt; 2         0     0 0.01626162</span></span>
<span><span class="co">#&gt; 3         0     0 0.01626174</span></span>
<span><span class="co">#&gt; 4         0     0 0.01668232</span></span>
<span><span class="co">#&gt; 5         0     0 0.01876681</span></span>
<span><span class="co">#&gt; 6         0     0 0.01944589</span></span>
<span><span class="co"># last few features (highest-dimensional)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">rpp_phom</span><span class="op">)</span></span>
<span><span class="co">#&gt;     dimension     birth     death</span></span>
<span><span class="co">#&gt; 325         2 0.8679664 0.8840139</span></span>
<span><span class="co">#&gt; 326         2 0.8637853 0.9014743</span></span>
<span><span class="co">#&gt; 327         2 0.8626085 0.9042318</span></span>
<span><span class="co">#&gt; 328         2 0.6801515 0.9085031</span></span>
<span><span class="co">#&gt; 329         2 0.5814553 0.5835716</span></span>
<span><span class="co">#&gt; 330         2 0.3907762 0.3928555</span></span></code></pre></div>
<p>Since we are interested in persistent features, let us have a look at the most persistent of these pairs:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rpp_pers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">rpp_phom</span>, persistence <span class="op">=</span> <span class="va">death</span> <span class="op">-</span> <span class="va">birth</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rpp_pers</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">rpp_pers</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">persistence</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span>, n <span class="op">=</span> <span class="fl">12L</span><span class="op">)</span></span>
<span><span class="co">#&gt;     dimension     birth     death persistence</span></span>
<span><span class="co">#&gt; 271         1 0.2722781 0.8486294   0.5763513</span></span>
<span><span class="co">#&gt; 239         0 0.0000000 0.3316291   0.3316291</span></span>
<span><span class="co">#&gt; 258         1 0.3352266 0.6621819   0.3269553</span></span>
<span><span class="co">#&gt; 238         0 0.0000000 0.3265027   0.3265027</span></span>
<span><span class="co">#&gt; 237         0 0.0000000 0.3210082   0.3210082</span></span>
<span><span class="co">#&gt; 236         0 0.0000000 0.3131056   0.3131056</span></span>
<span><span class="co">#&gt; 235         0 0.0000000 0.3109435   0.3109435</span></span>
<span><span class="co">#&gt; 234         0 0.0000000 0.3108577   0.3108577</span></span>
<span><span class="co">#&gt; 233         0 0.0000000 0.3044929   0.3044929</span></span>
<span><span class="co">#&gt; 232         0 0.0000000 0.2999689   0.2999689</span></span>
<span><span class="co">#&gt; 231         0 0.0000000 0.2998088   0.2998088</span></span>
<span><span class="co">#&gt; 230         0 0.0000000 0.2929086   0.2929086</span></span></code></pre></div>
<p>This table reveals that a single feature dominates the rest, with persistence nearly 0.6 versus just over 0.4 for the next-most persistent features. Nevertheless, graphical visualization would allow us to more easily and effectively interpret the complete collection of features than printing raw data. We will start off by plotting this as a topological barcode.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
</div>
<div class="section level2">
<h2 id="topological-barcode">Topological barcode<a class="anchor" aria-label="anchor" href="#topological-barcode"></a>
</h2>
<p>Topological barcodes plot features as vertically stacked horizontal bars <span class="citation">(Carlsson et al. 2004; Ghrist 2008)</span>. Each bar corresponds to a single feature, with the left boundary of the bar corresponding to the ball radius at which the feature appears in the simplicial complex (column <code>"birth"</code> in <code>rpp_phom</code>) and the right boundary of the bar corresponding to the radius at which the feature disappears (column <code>"death"</code>). Creating a topological barcode with <strong>ggtda</strong> is straightforward using <code><a href="../reference/barcode.html">geom_barcode()</a></code>, with the persistence aesthetics <code>start</code> and <code>end</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create topological barcode with appropriate theme</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rpp_phom</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">birth</span>, end <span class="op">=</span> <span class="va">death</span>,</span>
<span>                     group <span class="op">=</span> <span class="va">dimension</span>, colour <span class="op">=</span> <span class="va">dimension</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/barcode.html">geom_barcode</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Simplicial complex diameter"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/themes.html">theme_barcode</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualize-persistence_files/figure-html/barcode-1.png" width="480"></p>
<p>This layer is coded as a graphical element (“geom”) rather than as a statistical transformation (“stat”) because the data undergo no computations—only aesthetic mappings—before the barcode is rendered. The <code>group</code> aesthetic orders features by dimension to ensure that all 0-dimensional features a plotted in one group, all 1-dimensional features above them, and so on. The <code>color</code> aesthetic visually discriminates between features of different dimensions. The barcode theme removes gridlines and the vertical axis, since these are irrelevant to reading the plot.</p>
<p>Given that <span class="math inline">\(\mathbb{P}^2(\mathbb{R})\)</span> has first homology group of rank 1, the dominant 1-dimensional feature (or 1-cycle) appears as expected. Other features of, say, secondary persistence also emerge, and we will discuss them later, after we have showcased some alternative representations of these data.</p>
</div>
<div class="section level2">
<h2 id="persistence-diagrams">Persistence diagrams<a class="anchor" aria-label="anchor" href="#persistence-diagrams"></a>
</h2>
<p>Persistence diagrams plot features as points on a scatterplot <span class="citation">(Edelsbrunner, Letscher, and Zomorodian 2002)</span>. Each point corresponds to a single feature, so that features with equal births and deaths yield overlapping points. They are generated using <code><a href="../reference/persistence.html">stat_persistence()</a></code> as below, using the same persistence aesthetics. This is indeed a stat layer, in that the coordinates are calculated differently from the data depending on the layout. By default, persistence diagrams take the conventional “diagonal” layout: A feature born at <span class="math inline">\(b\)</span> and dead at <span class="math inline">\(d\)</span> is located at coordinates <span class="math inline">\((b,d)\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create persistence diagram with appropriate theme</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rpp_phom</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">birth</span>, end <span class="op">=</span> <span class="va">death</span>,</span>
<span>                     shape <span class="op">=</span> <span class="va">dimension</span>, colour <span class="op">=</span> <span class="va">dimension</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/persistence.html">stat_persistence</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Feature appearance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Feature disappearance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/themes.html">theme_persist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualize-persistence_files/figure-html/diagonal%20diagram-1.png" width="432"></p>
<p>The reference line <span class="math inline">\(y=x\)</span> often aids the interpretation of diagonal persistence diagrams, so we add one with <code><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline()</a></code>. (This may become a default annotation in a future version.) Aesthetically, it is also generally pleasing to have the vertical and horizontal axes on a fixed coordinate system with both plotting the same range, achieved with <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal()</a></code>. The <code>shape</code> and <code>colour</code> aesthetics together discriminate between features of different dimensions. This is particularly useful when one of the aesthetics (e.g. color) is rendered ineffective (e.g. for color-blind viewers).</p>
<p>Flat persistence diagrams can also be generated with <code><a href="../reference/persistence.html">stat_persistence()</a></code>, by setting the <code>diagram</code> parameter to <code>"flat"</code> <span class="citation">(Wadhwa et al. 2019)</span>. In this layout, the horizontal coordinate is equal to the radius at which each feature appears (column <code>"birth"</code>) and the vertical coordinate is equal to the <em>persistence</em> of the feature (the difference between <code>"death"</code> and <code>"birth"</code>). While these dimensions can be understood to lie on the same scale, the usefulness of the plot lies in recognizing the most persistent features by height and their relative appearences by birth, so it is less essential to fix the aspect ratio.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create flat persistence diagrams with adjustments</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rpp_phom</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">birth</span>, end <span class="op">=</span> <span class="va">death</span>,</span>
<span>                     shape <span class="op">=</span> <span class="va">dimension</span>, colour <span class="op">=</span> <span class="va">dimension</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/persistence.html">stat_persistence</a></span><span class="op">(</span>diagram <span class="op">=</span> <span class="st">"flat"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Feature appearance"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Feature persistence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/themes.html">theme_persist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualize-persistence_files/figure-html/flat%20diagram-1.png" width="432"></p>
</div>
<div class="section level2">
<h2 id="persistence-landscapes">Persistence landscapes<a class="anchor" aria-label="anchor" href="#persistence-landscapes"></a>
</h2>
<p>Persistence landscapes vectorize persistence diagrams as real-valued functions over the parameter range. The convenient statistical properties of landscapes are outside the scope of this package, but the <code><a href="../reference/landscape.html">stat_landscape()</a></code> layer provides elegant visualizations of landscapes derived from single diagrams. Whereas persistente diagrams default to the diagonal layout, landscapes default to the “landscape” layout:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot a persistent landscape for each dimension</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rpp_phom</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">birth</span>, end <span class="op">=</span> <span class="va">death</span>,</span>
<span>                     alpha <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">level</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/landscape.html">stat_landscape</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">dimension</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha_continuous</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"reverse"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/themes.html">theme_persist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">end</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span>
<span><span class="co">#&gt; Warning: The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">start,</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">end</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span>
<span><span class="co">#&gt; The following aesthetics were dropped during statistical transformation: <span style="color: #00BB00;">start,</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">end</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> This can happen when ggplot fails to infer the correct grouping structure in</span></span>
<span><span class="co">#&gt;   the data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Did you forget to specify a `group` aesthetic or to convert a numerical</span></span>
<span><span class="co">#&gt;   variable into a factor?</span></span></code></pre></div>
<p><img src="visualize-persistence_files/figure-html/persistence%20landscape-1.png" width="432"></p>
<p>Because landscapes take up more space than diagrams, those for different dimensions are rarely if ever overlaid. Instead, above they are faceted into three panels for ease of comparison.</p>
</div>
<div class="section level2">
<h2 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h2>
<p>As mentioned above, the dominant feature detected in the point cloud <code>rpp</code> is a 1-cycle that persists from radius 0.28 to radius 0.85 nearly twice the persistence of any other feature. Still, the flat persistence diagram reveals that some other degree-1 and -2 features stand out from the rest.</p>
<p>One way to convince ourselves that these are artifacts of noise in the sample is to compare their persistence to that of the degree-0 features. The latter are merely disconnected components, which finally disappear when the radius becomes large enough for the filtration to link every sampled point to every other. That the most persistent 1- and 2-cycles (other than the dominant 1-cycle) persist for no more than this “cut radius” of the point cloud suggests that they can plausibly be attributed to noise.</p>
<p>In particular, the most persistent 2-cycle, which stands out clearly in the landscape from its fellow 2-cycles, may be understood as a <em>geometric</em> rather than a <em>topological</em> feature. Each Vietoris–Rips complex of the filtration is built of simplices on points within the associated distance (the radius) of each other—and these distances are in <span class="math inline">\(\mathbb{R}^4\)</span>, not in <span class="math inline">\(\mathbb{P}^2(\mathbb{R})\)</span>. When the radius can reach between regions of the manifold embedded nearby in 4-space but not completely across, some purely topological features may collapse into features that are artifacts of the embedding. For a more intuitive example, imagine sampling points from a bottle with a narrow spout: A cover that connects nearby points will effectively plug the spout well before it fills the interior of the bottle, producing a persistent degree-2 feature though the manifold has null degree-2 homology.</p>
<p>In real-world settings, we may rarely have topological insight beyond a point cloud itself. So, while we can be wary of homological features of “middling” persistence, we should also not dismiss them.</p>
</div>
<div class="section level2">
<h2 id="ggplot2-functionality">
<strong>ggplot2</strong> functionality<a class="anchor" aria-label="anchor" href="#ggplot2-functionality"></a>
</h2>
<p>Plots produced using <strong>ggtda</strong> can be handled like any other <code>"ggplot"</code> objects—for example, they can be saved using <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggplot2::ggsave()</a></code>. Running the following line of code will save the most recent plot (the landscapes) as a PNG image file named <code>my-plot.png</code> in the local working directory.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"my-plot.png"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bauer2021" class="csl-entry">
Bauer, Ulrich. 2021. <span>“Ripser: Efficient Computation of <span>Vietoris</span><span></span><span>Rips</span> Persistence Barcodes.”</span> <em>Journal of Applied and Computational Topology</em> 5 (June): 391–423. <a href="https://doi.org/10.1007/s41468-021-00071-5" class="external-link">https://doi.org/10.1007/s41468-021-00071-5</a>.
</div>
<div id="ref-Carlsson2004" class="csl-entry">
Carlsson, Gunnar, Afra Zomorodian, Anne Collins, and Leonidas Guibas. 2004. <span>“Persistence Barcodes for Shapes.”</span> In <em>Proceedings of the 2004 <span>Eurographics</span>/<span>ACM SIGGRAPH</span> Symposium on <span>Geometry</span> Processing</em>, 124–35. <span>SGP</span> ’04. <span>New York, NY, USA</span>: <span>Association for Computing Machinery</span>. <a href="https://doi.org/10.1145/1057432.1057449" class="external-link">https://doi.org/10.1145/1057432.1057449</a>.
</div>
<div id="ref-Edelsbrunner2002" class="csl-entry">
Edelsbrunner, Letscher, and Zomorodian. 2002. <span>“Topological <span>Persistence</span> and <span>Simplification</span>.”</span> <em>Discrete &amp; Computational Geometry</em> 28 (4): 511–33. <a href="https://doi.org/10.1007/s00454-002-2885-2" class="external-link">https://doi.org/10.1007/s00454-002-2885-2</a>.
</div>
<div id="ref-Ghrist2008" class="csl-entry">
Ghrist, Robert. 2008. <span>“Barcodes: <span>The</span> Persistent Topology of Data.”</span> <em>Bulletin of the American Mathematical Society</em> 45 (1): 61–75. <a href="https://doi.org/10.1090/S0273-0979-07-01191-3" class="external-link">https://doi.org/10.1090/S0273-0979-07-01191-3</a>.
</div>
<div id="ref-Wadhwa2019" class="csl-entry">
Wadhwa, Raoul R., Andrew Dhawan, Drew F. K. Williamson, and Jacob G. Scott. 2019. <span>“A Flat Persistence Diagram for Improved Visualization of Persistent Homology.”</span> <span>arXiv</span>. <a href="https://doi.org/10.48550/arXiv.1812.04567" class="external-link">https://doi.org/10.48550/arXiv.1812.04567</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>For a simpler example using a noisy circle, see the README.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Ripser computes <em>reduced homology</em> <span class="math inline">\(\tilde{H}_k\)</span>, so that all homological features eventually die as the radius of the cover exceeds the diameter of the point cloud. The (non-reduced) degree-0 homology <span class="math inline">\(H_0\)</span> of any connected topological space has rank 1, which would result in an infinite degree-0 feature in persistent homology.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Ripser <span class="citation">(Bauer 2021)</span> computes persistent homology using prime field coefficients for any prime characteristic <span class="math inline">\(p&lt;2^{16}\)</span>. Over integer coefficients, <span class="math inline">\(\tilde{H}_1(\mathbb{P}^2(\mathbb{R}))=\mathbb{Z}/2\mathbb{Z}\)</span> is cyclic; in our discussion we dodge this issue of torsion.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Although <code><a href="https://rrrlw.github.io/ripserr/reference/vietoris_rips.html" class="external-link">ripserr::vietoris_rips()</a></code> calculates persistent homology using the Vietoris–Rips filtration, persistent homology from other filtrations (e.g. of Čech complexes) can also be visualized with ggtda. We will therefore label the axes in a generic manner that can then be specialized by users depending on their specific context.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason Cory Brunson, James Otto, Raoul Wadhwa, David Kahle, Jacob Scott.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
